<div class="bg-white rounded-xl border border-gray-200 p-6 space-y-4">
  <div class="flex justify-between items-center">
    <h2 class="text-xl font-semibold">Overview</h2>
    <button (click)="onToggleEdit.emit()" class="text-blue-600 hover:text-blue-800">
      {{ isEditing ? 'Cancel' : 'Edit' }}
    </button>
  </div>

  <div *ngIf="profile" class="space-y-4">
    <!-- Profile Photo Section -->
    <div class="flex items-center gap-4">
      <div class="w-20 h-20 rounded-full bg-blue-100 flex items-center justify-center text-sm text-gray-600">
        Add Photo
      </div>
      <div *ngIf="!isEditing" class="space-y-1">
        <p class="text-lg font-semibold">{{ profile.firstName }} {{ profile.lastName }}</p>
        <p class="text-gray-500">{{ profile.address }}</p>
        <p class="text-xs text-gray-500 flex items-center gap-1 mt-1">
          <span>⭐</span>
          {{ averageRating | number:'1.1-2' }} ({{ allCleanerReviews.length }} reviews)
        </p>
      </div>
    </div>

    <!-- Editing Form -->
    <div *ngIf="isEditing" class="space-y-4">
      <div>
        <label class="block text-sm font-medium text-gray-700">First Name</label>
        <input [(ngModel)]="profile.firstName" class="border px-2 py-1 rounded w-full" />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Last Name</label>
        <input [(ngModel)]="profile.lastName" class="border px-2 py-1 rounded w-full" />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Email</label>
        <input [(ngModel)]="profile.email" class="border px-2 py-1 rounded w-full" type="email" />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Phone</label>
        <input [(ngModel)]="profile.phone" class="border px-2 py-1 rounded w-full" type="tel" />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Address</label>
        <input [(ngModel)]="profile.address" class="border px-2 py-1 rounded w-full" />
      </div>
      <button (click)="onSave.emit()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
        Save
      </button>
    </div>

    <!-- Profile Details in View Mode -->
    <div *ngIf="!isEditing" class="space-y-4">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700">Email</label>
          <p class="text-gray-800">{{ profile.email }}</p>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Phone</label>
          <p class="text-gray-800">{{ profile.phone || 'Not provided' }}</p>
        </div>
      </div>
    </div>

    <!-- Reviews Section -->
    <div *ngIf="allCleanerReviews.length > 0" class="mt-6 border-t pt-4">
      <div class="text-sm font-semibold text-gray-700 mb-2">Reviews</div>
      <div [ngClass]="{'max-h-60 overflow-y-auto': showAllReviews}" class="transition-all duration-300">
        <div *ngFor="let review of displayedReviews" class="mb-3 pb-3 border-b last:border-b-0">
          <div class="flex items-center gap-2 mb-1">
            <ng-container *ngFor="let star of [1,2,3,4,5]">
              <span [ngClass]="review.rating >= star ? 'text-yellow-500' : 'text-gray-300'">★</span>
            </ng-container>
            <span class="text-xs text-gray-500 ml-2">{{ review.date | date:'mediumDate' }}</span>
          </div>
          <div class="text-gray-800 text-sm">{{ review.comment || review.message }}</div>
        </div>
      </div>
      <button *ngIf="allCleanerReviews.length > 3" (click)="toggleShowAllReviews()"
        class="mt-2 text-xs text-blue-600 underline">
        {{ showAllReviews ? 'See less' : 'See more' }}
      </button>
    </div>
  </div>
</div>